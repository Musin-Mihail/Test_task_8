# Симуляция сбора ресурсов дронами фракций

Этот проект Unity имитирует автоматический сбор ресурсов дронами двух фракций и их возвращение на базу. Параметры симуляции настраиваются через пользовательский интерфейс.

---

## Реализованные функции

В этом разделе описаны функции, которые были успешно реализованы в соответствии с предоставленным техническим заданием.

### Основная логика симуляции

* **Игровое поле:**
    * Открытая **2D-сцена** служит игровым полем.
    * **Две базы** стратегически расположены на противоположных сторонах сцены, визуально различаются красная и синяя.
    * **Ресурсы** появляются в случайных позициях на сцене через настраиваемый интервал.

* **Поведение дронов:**
    * Дроны равномерно распределены между двумя фракциями.
    * Каждый дрон независимо выполняет следующий цикл:
        1.  **Поиск ресурса:** Находит ближайший свободный ресурс.
        2.  **Навигация:** Летит к ресурсу.
        3.  **Сбор ресурса:** Остается в месте расположения ресурса в течение **2 секунд**, после чего ресурс исчезает.
        4.  **Возвращение на базу:** Возвращается на базу своей фракции.
        5.  **Выгрузка ресурса:** При возвращении на базу запускает **визуальный эффект** частицы, чтобы обозначить доставку ресурса.
        6.  **Повторение цикла:** Немедленно начинает новый цикл сбора.

### Пользовательский интерфейс (UI)

Комплексный пользовательский интерфейс обеспечивает динамическое управление симуляцией:

* **Ползунок: Количество дронов на фракцию:** Регулирует количество дронов для каждой фракции (от 1 до 10 на фракцию).
* **Ползунок: Скорость дронов:** Контролирует скорость передвижения всех дронов (от 1 до 10).
* **Поле ввода: Частота генерации ресурсов:** Изменяет, как часто новые ресурсы появляются на сцене.
* **Чекбокс: Включение/отключение отрисовки пути дрона:** Включает или отключает визуальное отображение путей дронов.
* **Счетчики ресурсов:** Отображает общее количество ресурсов, собранных каждой фракцией.

### Реализованные опциональные функции

* **Цветовое различие дронов:** Дроны четко различаются по цвету в соответствии со своей фракцией.
* **Выбор дрона для слежения:** При этом над ним появляется его статус.
* **Миникарта**
* **Управление скоростью симуляции** 

---

## Обзор архитектуры

Проект придерживается чистой, **компонентной архитектуры** для обеспечения удобства сопровождения, читаемости и масштабируемости.

* **Модульный дизайн:** Проект разделен на отдельные, независимые компоненты, каждый из которых имеет четкую и единственную ответственность. Такой подход минимизирует взаимозависимости и способствует повторному использованию.
* **Компонентная логика:** Игровые объекты состоят из нескольких специализированных компонентов, а не из монолитных "объектов-богов".
* **Слабая связанность:** Зависимости между объектами сведены к минимуму и обычно управляются через интерфейсы или события, избегая жестких, прописанных связей. Это облегчает модификации и расширения, не затрагивая несвязанные части системы.
* **Читаемость:** Кодовая база структурирована с четкими соглашениями об именовании, последовательным форматированием и соответствующими комментариями для повышения читаемости и понимания.

### Ключевые компоненты и логика

* **`GameManager`**: Синглтон, который выступает в качестве центрального контроллера игры.
    * Отвечает за инициализацию `DroneManager` и `ResourceManager`.
    * Управляет глобальными параметрами симуляции, такими как количество дронов на фракцию, скорость дронов, частота появления ресурсов и отрисовка пути дронов.
    * Обрабатывает загрузку сцены и переход между сценами.
    * Запускает корутины для спавна дронов и ресурсов.
* **`DroneManager`**: Отвечает за управление дронами.
    * Инициализирует префаб дрона.
    * Создает новые экземпляры дронов в указанных позициях.
    * Хранит список всех активных дронов.
* **`ResourceManager`**: Управляет ресурсами в игре.
    * Использует `ResourcePool` для эффективного создания и переиспользования ресурсов.
    * Предоставляет методы для спавна, уничтожения (возврата в пул) и получения списка активных ресурсов.
* **`ResourcePool`**: Реализует паттерн "пул объектов" для ресурсов.
    * Хранит доступные и активные ресурсы в очередях и списках.
    * Создает новые ресурсы при необходимости и возвращает их в пул, когда они не используются.
* **`Base`**: Представляет базу фракции.
    * Отслеживает общее количество сброшенных ресурсов.
    * Предоставляет метод `DepositResource()` для приема ресурсов и вызывает событие `OnResourceDeposited` для обновления UI.
    * Воспроизводит частицы при выгрузке ресурса.
* **`Drone`**: Основной компонент, представляющий дрон.
    * Содержит уникальный `DroneID` и ссылку на свою `Base` и `BaseObj`.
    * Имеет состояние (`Enums.DroneState`), которое указывает на текущее действие дрона (поиск, сбор, доставка).
    * Инициализирует свой цвет в соответствии с цветом базового объекта.
* **`DroneMovement`**: Отвечает за навигацию и поведение дрона.
    * Использует `NavMeshAgent` для перемещения.
    * Находит ближайший свободный ресурс и устанавливает его в качестве цели.
    * Перемещается к ресурсу, затем к базе после сбора.
    * Реализует задержку перед сбором ресурса и запускает анимацию.
    * Вызывает метод `DepositResourceAtBase()` после достижения базы.
* **`ResourceCollector`**: Отвечает за логику сбора ресурсов.
    * Инициализируется ссылками на `ResourceManager` и `Drone`.
    * Вызывает метод `DestroyResource` в `ResourceManager` для возврата ресурса в пул.
* **`Resource`**: Компонент, прикрепленный к каждому объекту ресурса.
    * Имеет флаг `isAvailable`, указывающий, может ли ресурс быть собран.
    * Предоставляет метод `PlayCollectionAnimation()` для воспроизведения визуального эффекта при сборе.
* **`PathDrawer`**: Компонент для отрисовки пути дрона.
    * Использует `LineRenderer` для визуализации пройденного пути.
    * Добавляет точки к пути, если они достаточно далеко от предыдущей.
    * Состояние отрисовки пути контролируется настройками `GameManager`.

---

## Использованные инструменты и подходы

* **Версия Unity:** Unity LTS 6000.0.x.
* **Навигация:** Для движения дронов используется `NavMeshAgent`.
* **Пул объектов:** Для ресурсов используется **пул объектов** (`ResourcePool`) для оптимизации производительности за счет уменьшения накладных расходов на создание/уничтожение.
* **События/Делегаты:** Используются для связи между разрозненными компонентами для поддержания слабой связанности.

---

## Визуальная демонстрация

* **Скриншоты/Видео:** https://disk.yandex.ru/i/Bg_dZYLDoXWLCA

## Скомпилированная сборка

* **Релиз на GitHub:** https://github.com/Musin-Mihail/Test_task_8/releases/tag/publish2

---

## Git-атрибуты

Файл `.gitattributes` был настроен в репозитории для обеспечения правильной обработки файлов, специфичных для Unity, предотвращения ненужных конфликтов слияния и оптимизации размера репозитория.
